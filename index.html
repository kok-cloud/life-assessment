function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Data');
    const data = JSON.parse(e.postData.contents);

    const row = [
      new Date(),
      data.fullName || '',
      data.organization || '',
      data.email || '',
      data.averageScore || '',
      data.totalScores || '',
      data.healthScore || ''
    ];

    sheet.appendRow(row);

    return ContentService
      .createTextOutput(JSON.stringify({ result: 'success' }))
      .setMimeType(ContentService.MimeType.JSON);
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({ result: 'error', message: error.message }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
